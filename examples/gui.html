<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>three.js GUI</title>
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="shortcut icon" href="../files/images/favicon.ico" />
		<link type="text/css" rel="stylesheet" href="main.css">
		<style>
			body {
				background-color: #cce0ff;
				color: #000;
			}
			a {
				color: #08f;
			}
		</style>
	</head>

	<body>
		<div id="info">
			<h2><a href="http://threejs.org" target="_blank" rel="noopener">three.js</a> - GUI</h2>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script>
		
		<script type="module">

			import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.117.0/build/three.module.js';
			import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.117.0/examples/jsm/controls/OrbitControls.js';
			import { GUI } from 'https://cdn.jsdelivr.net/npm/three@0.117.0/examples/jsm/libs/dat.gui.module.js';

			var SCREEN_WIDTH = window.innerWidth;
			var SCREEN_HEIGHT = window.innerHeight;
			var aspect = SCREEN_WIDTH / SCREEN_HEIGHT;

			var container;
			var camera, scene, renderer;
			var gcontrol;
			var loader = new THREE.TextureLoader();

			init();
			animate();

			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				// scene

				scene = new THREE.Scene();
				
				// camera

				camera = new THREE.PerspectiveCamera( 30, aspect, 1, 10000 );
				camera.position.set( 0, 250, 250 );

				// renderer

				renderer = new THREE.WebGLRenderer();
				renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );
				renderer.setClearColor(0xcce0ff);

				container.appendChild( renderer.domElement );

				// controls

				var controls = new OrbitControls( camera, renderer.domElement );

				// grid

				let gridXZ = new THREE.GridHelper(200, 20, 'red', 'black');
				scene.add(gridXZ);

				// resize

				window.addEventListener( 'resize', onWindowResize, false );

				// iron man

				let ironman = new THREE.Group();
				ironman.name = "ironman";
				scene.add(ironman);

				// head

				let head = makeHead();
				head.name = "head";
				head.position.y = 30;
				ironman.add(head);
				
				// torso

				let torso = makeTorso();
				torso.name = "torso";
				torso.position.y = 22.5;
				ironman.add(torso);
				
				// left leg
				
				let legLeft = makeLeftLeg();
				legLeft.name = "legLeft";
				legLeft.position.x = 2.5;
				legLeft.position.y = 15;
				legLeft.rotation.z = -Math.PI/2;
				legLeft.rotation.order = 'ZYX';
				ironman.add(legLeft);

				// right leg

				let legRight = makeRightLeg();
				legRight.name = "legRight";
				legRight.position.x = -2.5;
				legRight.position.y = 15;
				legRight.rotation.z = -Math.PI/2;
				legRight.rotation.order = 'ZYX';
				ironman.add(legRight);

				// left arm
				
				let armLeft = makeLeftArm();
				armLeft.name = "armLeft";
				armLeft.position.x = 7.5;
				armLeft.position.y = 30;
				armLeft.rotation.z = -Math.PI/2;
				armLeft.rotation.order = 'ZYX';
				ironman.add(armLeft);

				// right arm
				
				let armRight = makeRightArm();
				armRight.name = "armRight";
				armRight.position.x = -7.5;
				armRight.position.y = 30;
				armRight.rotation.z = -Math.PI/2;
				armRight.rotation.order = 'ZYX';
				ironman.add(armRight);

				// gui

				gcontrol = {
					HeadTheta:0.01,
					LeftArmTheta: 0.01,
					RightArmTheta: 0.01,
					LeftLegTheta: 0.01,
					RightLegTheta: 0.01,
				};

				let gui = new GUI();
				gui.domElement.id = 'gui';

				gui.add(gcontrol, 'HeadTheta', -0.8, 0.8);
				gui.add(gcontrol, 'LeftArmTheta', -0.8, 0.8);
				gui.add(gcontrol, 'RightArmTheta', -0.8, 0.8); 
				gui.add(gcontrol, 'LeftLegTheta', -0.8, 0.8);
				gui.add(gcontrol, 'RightLegTheta', -0.8, 0.8);
				
			}
			
			function makeHead() {

				let group = new THREE.Group();

				let head1 = loader.load('../files/images/ironman/head1.png');
				let head2 = loader.load('../files/images/ironman/head2.png');
				let head3 = loader.load('../files/images/ironman/head3.png');
				let head4 = loader.load('../files/images/ironman/head4.png');
				let head5 = loader.load('../files/images/ironman/head5.png');
				let head6 = loader.load('../files/images/ironman/head6.png');
				let geometryHead = new THREE.BoxBufferGeometry( 10, 10, 10 );
				let materialsHead = [
					new THREE.MeshBasicMaterial( { map: head1 } ),
					new THREE.MeshBasicMaterial( { map: head2 } ),
					new THREE.MeshBasicMaterial( { map: head3 } ),
					new THREE.MeshBasicMaterial( { map: head4 } ),
					new THREE.MeshBasicMaterial( { map: head5 } ),
					new THREE.MeshBasicMaterial( { map: head6 } ),
				];
				materialsHead = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let head = new THREE.Mesh( geometryHead, materialsHead );
				group.add(head);
				head.position.y = 5;

				group.add ( new THREE.AxesHelper (10) );

				return group;

			}
			
			function makeTorso() {

				let group = new THREE.Group();

				let torso1_2 = loader.load('../files/images/ironman/torso1_2.png');
				let torso3_4 = loader.load('../files/images/ironman/torso3_4.png');
				let torso5 = loader.load('../files/images/ironman/torso5.png');
				let torso6 = loader.load('../files/images/ironman/torso6.png');
				let geometryTorso = new THREE.BoxBufferGeometry( 10, 15, 5 );
				let materialsTorso = [
					new THREE.MeshBasicMaterial( { map: torso1_2 } ),
					new THREE.MeshBasicMaterial( { map: torso1_2 } ),
					new THREE.MeshBasicMaterial( { map: torso3_4 } ),
					new THREE.MeshBasicMaterial( { map: torso3_4 } ),
					new THREE.MeshBasicMaterial( { map: torso5 } ),
					new THREE.MeshBasicMaterial( { map: torso6 } ),
				];
				materialsTorso = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let torso = new THREE.Mesh( geometryTorso, materialsTorso );
				group.add(torso);
				
			//	group.add ( new THREE.AxesHelper (10) );

				return group;

			}

			function makeLeftLeg() {

				let group = new THREE.Group();

				let legleft1 = loader.load('../files/images/ironman/legleft1.png');
				let legleft2 = loader.load('../files/images/ironman/legleft2.png');
				let legleft3 = loader.load('../files/images/ironman/legleft3.png');
				let legleft4 = loader.load('../files/images/ironman/legleft4.png');
				let legleft5 = loader.load('../files/images/ironman/legleft5.png');
				let legleft6 = loader.load('../files/images/ironman/legleft6.png');
				
				let geometryLegLeft = new THREE.BoxBufferGeometry( 15, 5, 5 );
				let materialsLegLeft = [
					new THREE.MeshBasicMaterial( { map: legleft1 } ),
					new THREE.MeshBasicMaterial( { map: legleft2 } ),
					new THREE.MeshBasicMaterial( { map: legleft3 } ),
					new THREE.MeshBasicMaterial( { map: legleft4 } ),
					new THREE.MeshBasicMaterial( { map: legleft5 } ),
					new THREE.MeshBasicMaterial( { map: legleft6 } ),
				];
				materialsLegLeft = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let legleft = new THREE.Mesh( geometryLegLeft, materialsLegLeft );
				group.add(legleft);
				legleft.position.x = 7.5;
				
				group.add ( new THREE.AxesHelper (10) );

				return group;

			}

			function makeRightLeg() {

				let group = new THREE.Group();

				let legright1 = loader.load('../files/images/ironman/legright1.png');
				let legright2 = loader.load('../files/images/ironman/legright2.png');
				let legright3 = loader.load('../files/images/ironman/legright3.png');
				let legright4 = loader.load('../files/images/ironman/legright4.png');
				let legright5 = loader.load('../files/images/ironman/legright5.png');
				let legright6 = loader.load('../files/images/ironman/legright6.png');
				
				let geometryLegRight = new THREE.BoxBufferGeometry( 15, 5, 5 );
				let materialsLegRight = [
					new THREE.MeshBasicMaterial( { map: legright1 } ),
					new THREE.MeshBasicMaterial( { map: legright2 } ),
					new THREE.MeshBasicMaterial( { map: legright3 } ),
					new THREE.MeshBasicMaterial( { map: legright4 } ),
					new THREE.MeshBasicMaterial( { map: legright5 } ),
					new THREE.MeshBasicMaterial( { map: legright6 } ),
				];
				materialsLegRight = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let legright  = new THREE.Mesh( geometryLegRight, materialsLegRight );
				group.add(legright);
				legright.position.x = 7.5;

				group.add ( new THREE.AxesHelper (10) );

				return group;
				
			}

			function makeLeftArm() {

				let group = new THREE.Group();

				let armleft1 = loader.load('../files/images/ironman/armleft1.png');
				let armleft2 = loader.load('../files/images/ironman/armleft2.png');
				let armleft3 = loader.load('../files/images/ironman/armleft3.png');
				let armleft4 = loader.load('../files/images/ironman/armleft4.png');
				let armleft5 = loader.load('../files/images/ironman/armleft5.png');
				let armleft6 = loader.load('../files/images/ironman/armleft6.png');
				
				let geometryArmLeft = new THREE.BoxBufferGeometry( 15, 5, 5 );
				let materialsArmLeft = [
					new THREE.MeshBasicMaterial( { map: armleft1 } ),
					new THREE.MeshBasicMaterial( { map: armleft2 } ),
					new THREE.MeshBasicMaterial( { map: armleft3 } ),
					new THREE.MeshBasicMaterial( { map: armleft4 } ),
					new THREE.MeshBasicMaterial( { map: armleft5 } ),
					new THREE.MeshBasicMaterial( { map: armleft6 } ),
				];
				materialsArmLeft = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let armleft  = new THREE.Mesh( geometryArmLeft, materialsArmLeft );
				group.add(armleft);
				armleft.position.x = 7.5;
				
				group.add ( new THREE.AxesHelper (10) );

				return group;

			}

			function makeRightArm() {

				let group = new THREE.Group();

				let armright1 = loader.load('../files/images/ironman/armright1.png');
				let armright2 = loader.load('../files/images/ironman/armright2.png');
				let armright3 = loader.load('../files/images/ironman/armright3.png');
				let armright4 = loader.load('../files/images/ironman/armright4.png');
				let armright5 = loader.load('../files/images/ironman/armright5.png');
				let armright6 = loader.load('../files/images/ironman/armright6.png');
				
				let geometryArmRight = new THREE.BoxBufferGeometry( 15, 5, 5 );
				let materialsArmRight = [
					new THREE.MeshBasicMaterial( { map: armright1 } ),
					new THREE.MeshBasicMaterial( { map: armright2 } ),
					new THREE.MeshBasicMaterial( { map: armright3 } ),
					new THREE.MeshBasicMaterial( { map: armright4 } ),
					new THREE.MeshBasicMaterial( { map: armright5 } ),
					new THREE.MeshBasicMaterial( { map: armright6 } ),
				];
				materialsArmRight = new THREE.MeshNormalMaterial({transparent:true, opacity:0.5});
				let armright = new THREE.Mesh( geometryArmRight, materialsArmRight );
				group.add(armright);
				armright.position.x = 7.5;
				
				group.add ( new THREE.AxesHelper (10) );

				return group;

			}

			function onWindowResize() {

				SCREEN_WIDTH = window.innerWidth;
				SCREEN_HEIGHT = window.innerHeight;

				camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
				camera.updateProjectionMatrix();

				renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );

			}

			function animate() {
				
				let head = scene.getObjectByName("head");
				let armLeft = scene.getObjectByName("armLeft");
				let armRight = scene.getObjectByName("armRight");
				let legLeft = scene.getObjectByName("legLeft");
				let legRight = scene.getObjectByName("legRight");

				head.rotation.y = gcontrol.HeadTheta;
				armLeft.rotation.y = gcontrol.LeftArmTheta;
				armRight.rotation.y = gcontrol.RightArmTheta;
				legLeft.rotation.y = gcontrol.LeftLegTheta;
				legRight.rotation.y = gcontrol.RightLegTheta;

				requestAnimationFrame( animate );
				render();

			}

			function render() {

				renderer.render( scene, camera );

			}

		</script>
	</body>
</html>